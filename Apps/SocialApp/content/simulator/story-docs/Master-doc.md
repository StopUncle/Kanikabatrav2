# Relationship Simulator - Master Design Document

## Overview

A social dynamics simulator that teaches **pattern recognition**, not path memorization. Players learn to read people, navigate complex relationships, and manage social systems through recurring characters and consequence-driven gameplay.

---

## Core Philosophy

### What We're Teaching
- How to READ people (not memorize "correct" answers)
- How to manage relationships as a SYSTEM (not isolated encounters)
- That past choices have future consequences
- The "gray" of social dynamics - not good/evil, but CONTROL

### What We're NOT Doing
- Simple pattern matching ("see avoidant, do X")
- Disney morality (clear good/bad choices)
- Memorizable paths
- AI-generated content (for now - revisit when AI improves)

---

## The Gray: Moral Framework

It's not about being "good" or "bad" - it's about maintaining CONTROL of your social position.

**Examples:**
- Ally getting cocky? Remind them who helped them get there
- Someone useful but annoying? Tolerate them strategically
- Genuine threat? Neutralize without looking like the aggressor
- Need something from a narcissist? Give just enough to extract value, then pivot

**Sometimes you defend against manipulation. Sometimes you ARE the one maneuvering.**

This is realistic social dynamics, not a morality play.

---

## Scene Flow: Observe → Respond → Act

### Phase 1: OBSERVE
- Read the dialogue
- Notice behavioral cues
- Assess the situation

### Phase 2: RESPOND (Dialogue Choices)
- "How do you respond?"
- 2-3 options for what you SAY
- Determines SUCCESS / RELATIONSHIP IMPACT
- Affects rapport, respect, hidden loyalty

### Phase 3: ACT (Action Grid - 4 Panels)
- "What do you do next?"
- Physical actions: go here, do this, talk to them
- Determines STORY BRANCH
- Where the narrative goes next

**Key Insight:** What you SAY and what you DO are separate decisions.

---

## Goal Setting

Every scene needs:

```
OBJECTIVE: What you're trying to achieve
REASON: Why it matters (valid, compelling)
STAKES: What happens if you fail
```

**Example:**
- Objective: "Control the room"
- Reason: "Jay is trying to make you look weak in front of Taylor"
- Stakes: "Lose and you're socially dead at this party"

Goals give players PURPOSE, not just "pick the nice answer."

---

## Character System

### Key Recurring Characters

Characters are NOT one-scene NPCs. They appear across multiple levels. Relationships evolve. Past choices echo forward.

**University Cast:**
| Character | Type | Role |
|-----------|------|------|
| Morgan | Covert Narcissist | The powerful one, connected family |
| Taylor | Dismissive Avoidant | The beautiful one, tests everyone |
| Casey | Wallflower | Undervalued, potentially loyal ally |
| Jordan | Authority Figure | The RA, gatekeeper |
| Alex | Eager Competitor | Roommate, could be ally or rival |
| Riley | Social Magnet | High status, many orbiters |
| Sam | Chameleon | Neutral, follows social proof |

### Character Complexity

Characters are not single archetypes. They have:
- Primary type (narcissist, avoidant, genuine, etc.)
- Secondary traits (insecure, smart, vindictive, etc.)
- Situational behavior (changes based on context, mood, stakes)
- Relationships with OTHER characters (web of connections)

**Morgan isn't just "narcissist." Morgan is:**
- Narcissist + insecure + smart enough to adapt
- Dating Taylor (affects how you can interact with both)
- Rival to Riley for social dominance
- Will remember if you embarrassed them

---

## Relationship Tracking

### Visible Stats (Player Can See)

```
RAPPORT: How much they like you (0-100)
RESPECT: Do they take you seriously (0-100)
```

These give feedback. Player knows where they stand.

### Hidden Stats (Player Cannot See)

```
TRUE LOYALTY: Would they betray you when stakes are high? (0-100)
```

This creates drama. You THINK Taylor is your friend...

### Threshold-Based Behavior

Not smooth curves. Three states max:
- HIGH (70+): Favorable version of scenes
- MEDIUM (30-70): Neutral version
- LOW (0-30): Hostile version

Same scene, different dialogue/options based on relationship state.

---

## The Betrayal Mechanic

### How Hidden Loyalty Works

Throughout the game, Taylor's hidden loyalty shifts:

**Increases loyalty:**
- You help her when she needs it
- You keep her secrets
- You don't outshine her publicly
- You support her goals

**Decreases loyalty:**
- You take credit for something she did
- You get close to Morgan (who she hates)
- You embarrass her in public
- You outshine her repeatedly

### The Climax Reveal

At a critical story moment (Level 4 or 5):

```
IF loyalty > 60: Taylor warns you about the trap
IF loyalty < 40: Taylor IS the trap
```

Same story beat. Completely different experience.

### Foreshadowing

Drop subtle hints if loyalty is dropping:
- "Taylor seemed quiet when you got that compliment."
- "She didn't invite you to the pre-party."
- "You notice her talking to Morgan more lately."

Player CAN notice if paying attention. The betrayal feels earned, not random.

### Post-Betrayal Teaching

After the betrayal: "Remember when you took credit in Level 2? She never forgot."

Player learns what went wrong. Next playthrough, they know to watch for it.

---

## What Creates Nuance (Not Pattern Matching)

### 1. Conflicting Objectives
- You NEED Morgan's invite to the gala
- But Morgan is a narcissist
- Gray rock gets you nothing. Feeding ego makes you supply.
- Solution: Give JUST enough, extract value, pivot
- It's not "do X" - it's "how much X, for how long, when to stop"

### 2. Characters React to YOU
- You gray rock → They notice → They test harder
- You feed ego once → They expect it every time
- The "correct" move in isolation might be WRONG in sequence
- It's chess, not matching

### 3. The Web of Relationships
- Morgan is dating Taylor
- Taylor is friends with Casey
- You embarrass Morgan publicly → Taylor hates you → Casey is awkward
- You can't optimize for one person. You're managing a SYSTEM.

### 4. Incomplete Information + Commitment
- Is Morgan love bombing or genuinely interested? You don't KNOW yet.
- But you have to respond NOW.
- Probe without committing. Buy time. Gather more data.
- THEN decide your strategy.

### 5. The Reversal
- The "weak" person you manipulated in Level 1?
- They show up in Level 3 with STATUS now.
- They remember everything.

---

## Randomization for Replayability

### Emotional Presentation Variation

Same character, different emotional mask each playthrough:

```
Morgan at the party:

Playthrough 1: Cold, dismissive, subtle superiority
→ Covert narcissist vibes → Gray rock is correct

Playthrough 2: Warm, overly complimentary, intense eye contact
→ Love bombing vibes → Same narcissist, different mask

Playthrough 3: Stressed, apologetic, self-deprecating
→ Vulnerable narcissist vibes → Still don't give supply
```

**The underlying type stays the same. The presentation changes.**

Player can't memorize "Morgan = cold response." They have to READ the current state.

### Why This Works
- You already have the emotion system in silhouettes
- Mirrors reality (narcissists present differently based on mood/audience)
- Teaches the real skill (reading people, not remembering scripts)
- Same scenario structure, meaningful variation

---

## Complexity Management

### Different Paths → Same Destinations

```
Path A: Manipulate the weak guy → Get gala invite
Path B: Build genuine alliance → Get gala invite

Both work. One costs karma, one costs time.
The STORY continues the same, but YOUR CHARACTER is different.
```

This is how Telltale games work. Illusion of massive choice, but plot hits same beats.

### Key Moments Only

- Only 4-5 choices per level actually move relationship needles
- Rest is flavor/immersion
- Keeps authoring manageable
- Player feels every choice matters (because the key ones do)

### Three Variants Maximum

For any relationship-dependent scene:
- HIGH relationship version
- MEDIUM relationship version
- LOW relationship version

That's it. Not infinite permutations.

---

## UI Direction

### Keep
- Silhouettes with personality-based colors
- Emotion system (eye color changes)
- Hair/hat overlays for character distinction
- Relationship bars (Rapport, Respect)
- Action grid (4 panels) for physical choices
- Phase indicator (Observe → Respond → Act)

### Remove
- Player specs/stats panel
- Optimal percentage scoring at end
- Complex tactic labels (Strategic Empathy, etc.)

### Rename
- "Dating Simulator" → "Relationship Simulator"

---

## Scoring & Success

### No Optimal Percentage

If you reach the gala, you "won." The journey IS the experience.

### What Matters Instead
- Relationship states with each character
- Your reputation (how you're perceived by the group)
- Resources/allies accumulated
- Whether key characters trust you or will betray you

### The "Score" Is the Story

Did Taylor warn you or betray you? That's your score.
Did you build Casey into a loyal ally or leave them behind?
Did Morgan respect you or dismiss you?

The ending tells you how you did.

---

## Story Structure

### Level Progression

```
Level 1: University (Learn basics)
- Meet the cast
- Establish initial relationships
- Low stakes practice

Level 2: Social Scene (Apply skills)
- Parties, social events
- Navigate group dynamics
- Medium stakes

Level 3: The Gala (High stakes)
- Everything converges
- Betrayals reveal
- Relationships pay off or cost you

Level 4-5: [TBD - escalation]
```

### Branch Structure

Actions create branches, but branches converge at key story beats:
- End of Level 1: Everyone ends up at the same party
- End of Level 2: Everyone gets (or doesn't get) gala invite
- Level 3: Different experiences at gala based on relationships

---

## Technical Implementation

### Relationship Engine

The system is implemented as a pluggable module at `lib/relationshipEngine/`.

**Core Components:**

```
lib/relationshipEngine/
├── index.ts              # Main API - createRelationshipEngine()
├── types.ts              # Type definitions
├── RelationshipTracker.ts # Visible/hidden stat management
├── MoodRandomizer.ts     # Emotional presentation randomization
├── SceneResolver.ts      # Scene variant resolution
├── StoryConvergence.ts   # Path convergence management
└── examples/
    └── universityConfig.ts # Example configuration
```

**Usage:**

```typescript
import { createRelationshipEngine } from '../lib/relationshipEngine';

// Create engine with scenario config
const engine = createRelationshipEngine({
  scenarioId: 'university-level-1',
  characters: universityCharacters,
  betrayals: [taylorBetrayal],
  convergencePoints,
});

// Handle player choice
engine.handleChoice(
  'scene-id',
  'choice-id',
  'morgan',
  'tried to impress Morgan',
  { rapport: 5, respect: -5, loyalty: -10 }
);

// Get UI stats (visible only)
const stats = engine.getVisibleStats('taylor');
// { rapport: 65, respect: 70 }

// Check mood for scene resolution
const mood = engine.getCharacterMood('morgan');
// 'cold' | 'warm' | 'vulnerable' | 'charming' | etc.

// At climax - check betrayal
const outcome = engine.checkBetrayal('taylor');
// 'betrayal' | 'warning' | null

// After betrayal - get teaching
const teaching = engine.getPostBetrayalTeaching('taylor');
// ["Remember when you took credit in Level 2? She never forgot."]
```

### Character Definition

```typescript
const morgan: RelationshipCharacter = {
  id: 'morgan',
  name: 'Morgan',
  archetype: 'narcissist',
  secondaryTraits: ['insecure', 'smart', 'vindictive'],
  relationships: [
    { targetCharacterId: 'taylor', relationshipType: 'dating', rippleEffect: 0.5 },
    { targetCharacterId: 'riley', relationshipType: 'rival', rippleEffect: -0.3 },
  ],
  possiblePresentations: ['cold', 'warm', 'vulnerable', 'charming'],
  memoryTriggers: {
    positive: ['gave_attention', 'supported_publicly'],
    negative: ['embarrassed_public', 'outshone_them'],
  },
};
```

### Betrayal Configuration

```typescript
const taylorBetrayal: BetrayalConfig = {
  characterId: 'taylor',
  loyaltyThreshold: 40,
  climaxSceneId: 'scene-gala-moment-of-truth',
  betrayalOutcome: {
    sceneId: 'scene-taylor-betrays',
    description: 'Taylor leads you into the trap.',
  },
  warningOutcome: {
    sceneId: 'scene-taylor-warns',
    description: 'Taylor pulls you aside and warns you.',
  },
  foreshadowingMessages: {
    dropping: ['Taylor seemed quiet when you got that compliment.'],
    rising: ['Taylor smiled at you. It felt real.'],
    critical: ['Something feels off with Taylor.'],
  },
};
```

### Scene Variants

```typescript
// Scene template with relationship-based variants
const sceneTemplate: SceneTemplate = {
  baseScene: baseScene,
  variants: [{
    characterId: 'morgan',
    statType: 'rapport',
    high: {
      tier: 'high',
      dialogOverrides: [
        { originalLineIndex: 0, variantText: '"Hey, you made it!" Morgan actually looks pleased.' }
      ],
      choiceModifiers: [],
    },
    low: {
      tier: 'low',
      dialogOverrides: [
        { originalLineIndex: 0, variantText: 'Morgan barely acknowledges you.' }
      ],
      choiceModifiers: [
        { choiceId: 'choice-ask-favor', disabled: true } // Can't ask favor at low rapport
      ],
    },
  }],
};
```

---

## Future Considerations (Not Now)

### AI Integration (When Ready)
- Hybrid model: Authored structure + AI-generated flavor
- AI could vary dialogue within character constraints
- AI evaluation of free-form player responses
- Revisit when AI quality/consistency improves

### Current Focus
- Nail the core loop (Observe → Respond → Act)
- Build the character relationship system
- Create compelling authored content
- Test with users, iterate

---

## Summary

**What makes this different:**

1. **Recurring characters** with evolving relationships
2. **Hidden loyalty** creates genuine surprises
3. **The web** of relationships means you manage a system, not individuals
4. **Conflicting objectives** require real thought, not pattern matching
5. **Randomized presentation** prevents memorization
6. **Paths converge** keeps complexity manageable
7. **The gray** teaches realistic social dynamics

**The player learns:**
- How to read people
- How to manage relationships over time
- That actions have consequences
- That social dynamics are nuanced, not black/white

This is a skill trainer disguised as a game.
